<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Paint</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #2c3e50;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .app {
            width: 100%;
            max-width: 800px;
            height: 100vh;
            max-height: 1000px;
            background: white;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }

        /* Header */
        .header {
            padding: 15px 20px;
            background: #3498db;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 20px;
            font-weight: 600;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .header-btn {
            padding: 8px 15px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* Tools Sidebar */
        .tools-sidebar {
            width: 80px;
            background: #34495e;
            padding: 20px 10px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .tool-btn {
            width: 60px;
            height: 60px;
            background: #2c3e50;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .tool-btn.active {
            background: #3498db;
            transform: scale(1.1);
        }

        .tool-btn:hover {
            background: #3498db;
        }

        /* Canvas Container */
        .canvas-container {
            flex: 1;
            background: #ecf0f1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        #mainCanvas {
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            cursor: crosshair;
        }

        /* Properties Panel */
        .properties-panel {
            width: 250px;
            background: #34495e;
            padding: 20px;
            color: white;
        }

        .property-group {
            margin-bottom: 25px;
        }

        .property-title {
            font-size: 16px;
            margin-bottom: 10px;
            color: #bdc3c7;
        }

        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s;
        }

        .color-option.active {
            transform: scale(1.2);
            border-color: white;
        }

        .size-control {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .size-option {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px;
            border-radius: 5px;
            transition: background 0.2s;
        }

        .size-option:hover {
            background: rgba(255,255,255,0.1);
        }

        .size-option.active {
            background: rgba(52, 152, 219, 0.3);
        }

        .size-preview {
            border-radius: 50%;
            background: white;
        }

        .background-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .background-option {
            padding: 12px;
            background: #2c3e50;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            text-align: left;
            transition: background 0.2s;
        }

        .background-option.active {
            background: #3498db;
        }

        .background-option:hover {
            background: #3498db;
        }

        /* Footer */
        .footer {
            padding: 15px 20px;
            background: #3498db;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #2ecc71;
            color: white;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .notification.show {
            opacity: 1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .tools-sidebar {
                width: 100%;
                height: 80px;
                flex-direction: row;
                padding: 10px;
            }
            
            .tool-btn {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .properties-panel {
                width: 100%;
                height: auto;
            }
            
            .property-group {
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <div class="header">
            <div class="header-title">üé® Simple Paint</div>
            <div class="header-actions">
                <button class="header-btn" id="undoBtn">‚Ü∂ –û—Ç–º–µ–Ω–∞</button>
                <button class="header-btn" id="clearBtn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Tools Sidebar -->
            <div class="tools-sidebar">
                <button class="tool-btn active" data-tool="brush" title="–ö–∏—Å—Ç—å">üñåÔ∏è</button>
                <button class="tool-btn" data-tool="eraser" title="–õ–∞—Å—Ç–∏–∫">üßπ</button>
                <button class="tool-btn" data-tool="line" title="–õ–∏–Ω–∏—è">üìè</button>
                <button class="tool-btn" data-tool="rect" title="–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫">‚¨ú</button>
                <button class="tool-btn" data-tool="circle" title="–ö—Ä—É–≥">‚≠ï</button>
            </div>

            <!-- Canvas -->
            <div class="canvas-container">
                <canvas id="mainCanvas"></canvas>
            </div>

            <!-- Properties Panel -->
            <div class="properties-panel">
                <div class="property-group">
                    <div class="property-title">–¶–í–ï–¢</div>
                    <div class="color-palette">
                        <div class="color-option active" style="background: #000000;" data-color="#000000"></div>
                        <div class="color-option" style="background: #e74c3c;" data-color="#e74c3c"></div>
                        <div class="color-option" style="background: #2ecc71;" data-color="#2ecc71"></div>
                        <div class="color-option" style="background: #3498db;" data-color="#3498db"></div>
                        <div class="color-option" style="background: #9b59b6;" data-color="#9b59b6"></div>
                        <div class="color-option" style="background: #f1c40f;" data-color="#f1c40f"></div>
                        <div class="color-option" style="background: #e67e22;" data-color="#e67e22"></div>
                        <div class="color-option" style="background: #1abc9c;" data-color="#1abc9c"></div>
                    </div>
                </div>

                <div class="property-group">
                    <div class="property-title">–†–ê–ó–ú–ï–†</div>
                    <div class="size-control">
                        <div class="size-option active" data-size="2">
                            <div class="size-preview" style="width: 8px; height: 8px;"></div>
                            <span>–¢–æ–Ω–∫–∏–π</span>
                        </div>
                        <div class="size-option" data-size="5">
                            <div class="size-preview" style="width: 16px; height: 16px;"></div>
                            <span>–°—Ä–µ–¥–Ω–∏–π</span>
                        </div>
                        <div class="size-option" data-size="10">
                            <div class="size-preview" style="width: 24px; height: 24px;"></div>
                            <span>–¢–æ–ª—Å—Ç—ã–π</span>
                        </div>
                    </div>
                </div>

                <div class="property-group">
                    <div class="property-title">–§–û–ù</div>
                    <div class="background-options">
                        <button class="background-option active" data-background="white">–ë–µ–ª—ã–π —Ñ–æ–Ω</button>
                        <button class="background-option" data-background="grid">–°–µ—Ç–∫–∞</button>
                        <button class="background-option" data-background="transparent">–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <button class="footer-btn" id="saveBtn">
                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PNG
            </button>
            <button class="footer-btn" id="shareBtn">
                üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
            </button>
        </div>

        <!-- Notification -->
        <div class="notification" id="notification"></div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const state = {
            isDrawing: false,
            lastX: 0,
            lastY: 0,
            startX: 0,
            startY: 0,
            currentTool: 'brush',
            currentColor: '#000000',
            currentSize: 2,
            currentBackground: 'white',
            savedImage: null,
            history: [],
            historyIndex: -1
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            console.log('üé® –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Simple Paint...');
            
            setupCanvas();
            setupEventListeners();
            setupBackground();
            saveState();
            
            showNotification('Simple Paint –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
        }

        function setupCanvas() {
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
            const container = canvas.parentElement;
            const size = Math.min(container.clientWidth, container.clientHeight) - 40;
            
            canvas.width = size;
            canvas.height = size;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
            ctx.lineJoin = 'round';
            ctx.lineCap = 'round';
            ctx.lineWidth = state.currentSize;
            ctx.strokeStyle = state.currentColor;
            
            console.log(`üìê Canvas: ${canvas.width}x${canvas.height}`);
        }

        function setupEventListeners() {
            // –°–æ–±—ã—Ç–∏—è –º—ã—à–∏
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // –°–æ–±—ã—Ç–∏—è –∫–∞—Å–∞–Ω–∏—è
            canvas.addEventListener('touchstart', handleTouchStart);
            canvas.addEventListener('touchmove', handleTouchMove);
            canvas.addEventListener('touchend', stopDrawing);
            
            // –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const tool = e.currentTarget.dataset.tool;
                    setTool(tool);
                });
            });
            
            // –¶–≤–µ—Ç–∞
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const color = e.currentTarget.dataset.color;
                    setColor(color);
                });
            });
            
            // –†–∞–∑–º–µ—Ä—ã
            document.querySelectorAll('.size-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const size = parseInt(e.currentTarget.dataset.size);
                    setSize(size);
                });
            });
            
            // –§–æ–Ω—ã
            document.querySelectorAll('.background-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const background = e.currentTarget.dataset.background;
                    setBackground(background);
                });
            });
            
            // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
            document.getElementById('undoBtn').addEventListener('click', undo);
            document.getElementById('clearBtn').addEventListener('click', clearCanvas);
            document.getElementById('saveBtn').addEventListener('click', saveAsPNG);
            document.getElementById('shareBtn').addEventListener('click', shareDrawing);
            
            // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', debounce(setupCanvas, 250));
        }

        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousedown', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function handleTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function getCanvasCoordinates(e) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        }

        function startDrawing(e) {
            state.isDrawing = true;
            const coords = getCanvasCoordinates(e);
            
            state.lastX = coords.x;
            state.lastY = coords.y;
            state.startX = coords.x;
            state.startY = coords.y;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ñ–∏–≥—É—Ä
            if (['line', 'rect', 'circle'].includes(state.currentTool)) {
                state.savedImage = ctx.getImageData(0, 0, canvas.width, canvas.height);
            }
            
            // –ù–∞—á–∏–Ω–∞–µ–º –ø—É—Ç—å –¥–ª—è –∫–∏—Å—Ç–∏ –∏ –ª–∞—Å—Ç–∏–∫–∞
            if (state.currentTool === 'brush' || state.currentTool === 'eraser') {
                ctx.beginPath();
                ctx.moveTo(state.lastX, state.lastY);
            }
        }

        function draw(e) {
            if (!state.isDrawing) return;
            
            const coords = getCanvasCoordinates(e);
            const currentX = coords.x;
            const currentY = coords.y;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è
            if (state.currentTool === 'eraser') {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.strokeStyle = 'rgba(0,0,0,1)';
            } else {
                ctx.globalCompositeOperation = 'source-over';
                ctx.strokeStyle = state.currentColor;
            }
            
            ctx.lineWidth = state.currentSize;
            
            // –†–∏—Å–æ–≤–∞–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
            switch(state.currentTool) {
                case 'brush':
                case 'eraser':
                    ctx.lineTo(currentX, currentY);
                    ctx.stroke();
                    break;
                    
                case 'line':
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Ä–∏—Å—É–µ–º –ª–∏–Ω–∏—é
                    ctx.putImageData(state.savedImage, 0, 0);
                    ctx.beginPath();
                    ctx.moveTo(state.startX, state.startY);
                    ctx.lineTo(currentX, currentY);
                    ctx.stroke();
                    break;
                    
                case 'rect':
                    ctx.putImageData(state.savedImage, 0, 0);
                    ctx.strokeRect(
                        state.startX, 
                        state.startY, 
                        currentX - state.startX, 
                        currentY - state.startY
                    );
                    break;
                    
                case 'circle':
                    ctx.putImageData(state.savedImage, 0, 0);
                    const radius = Math.sqrt(
                        Math.pow(currentX - state.startX, 2) + 
                        Math.pow(currentY - state.startY, 2)
                    );
                    ctx.beginPath();
                    ctx.arc(state.startX, state.startY, radius, 0, 2 * Math.PI);
                    ctx.stroke();
                    break;
            }
            
            state.lastX = currentX;
            state.lastY = currentY;
        }

        function stopDrawing() {
            if (state.isDrawing) {
                state.isDrawing = false;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è
                if (state.currentTool !== 'brush') {
                    saveState();
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                ctx.globalCompositeOperation = 'source-over';
                state.savedImage = null;
            }
        }

        function setTool(tool) {
            state.currentTool = tool;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tool="${tool}"]`).classList.add('active');
            
            showNotification(`–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: ${getToolName(tool)}`);
        }

        function setColor(color) {
            state.currentColor = color;
            ctx.strokeStyle = color;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.querySelectorAll('.color-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`[data-color="${color}"]`).classList.add('active');
        }

        function setSize(size) {
            state.currentSize = size;
            ctx.lineWidth = size;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.querySelectorAll('.size-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`[data-size="${size}"]`).classList.add('active');
        }

        function setBackground(background) {
            state.currentBackground = background;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.querySelectorAll('.background-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`[data-background="${background}"]`).classList.add('active');
            
            drawBackground();
            restoreDrawing();
        }

        function drawBackground() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π —Ä–∏—Å—É–Ω–æ–∫
            const currentDrawing = state.history.length > 0 ? 
                state.history[state.historyIndex] : null;
            
            // –û—á–∏—â–∞–µ–º canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –†–∏—Å—É–µ–º —Ñ–æ–Ω
            switch(state.currentBackground) {
                case 'white':
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    break;
                    
                case 'grid':
                    drawGridBackground();
                    break;
                    
                case 'transparent':
                    // –î–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–≥–æ —Ñ–æ–Ω–∞ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∏—Å—É–µ–º
                    drawTransparentBackground();
                    break;
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∏—Å—É–Ω–æ–∫
            if (currentDrawing) {
                ctx.putImageData(currentDrawing, 0, 0);
            }
        }

        function drawGridBackground() {
            // –ë–µ–ª—ã–π —Ñ–æ–Ω
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –°–µ—Ç–∫–∞
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            const gridSize = 20;
            
            // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let x = 0; x < canvas.width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            
            // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let y = 0; y < canvas.height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }

        function drawTransparentBackground() {
            // –®–∞—Ö–º–∞—Ç–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏
            const size = 10;
            ctx.fillStyle = '#f0f0f0';
            
            for (let x = 0; x < canvas.width; x += size * 2) {
                for (let y = 0; y < canvas.height; y += size * 2) {
                    ctx.fillRect(x, y, size, size);
                    ctx.fillRect(x + size, y + size, size, size);
                }
            }
        }

        function setupBackground() {
            drawBackground();
        }

        function getToolName(tool) {
            const names = {
                'brush': '–ö–∏—Å—Ç—å',
                'eraser': '–õ–∞—Å—Ç–∏–∫',
                'line': '–õ–∏–Ω–∏—è',
                'rect': '–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫',
                'circle': '–ö—Ä—É–≥'
            };
            return names[tool] || tool;
        }

        // –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π
        function saveState() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            
            // –û–±—Ä–µ–∑–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (state.historyIndex < state.history.length - 1) {
                state.history = state.history.slice(0, state.historyIndex + 1);
            }
            
            state.history.push(imageData);
            state.historyIndex++;
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏
            if (state.history.length > 20) {
                state.history.shift();
                state.historyIndex--;
            }
        }

        function restoreDrawing() {
            if (state.historyIndex >= 0) {
                const imageData = state.history[state.historyIndex];
                ctx.putImageData(imageData, 0, 0);
            }
        }

        function undo() {
            if (state.historyIndex > 0) {
                state.historyIndex--;
                drawBackground();
                restoreDrawing();
                showNotification('–î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ');
            } else if (state.historyIndex === 0) {
                state.historyIndex = -1;
                drawBackground();
                showNotification('–î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ');
            }
        }

        function clearCanvas() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —Ö–æ–ª—Å—Ç? –í—Å–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
                state.historyIndex = -1;
                state.history = [];
                drawBackground();
                showNotification('–•–æ–ª—Å—Ç –æ—á–∏—â–µ–Ω');
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç
        function saveAsPNG() {
            const link = document.createElement('a');
            link.download = `drawing-${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
            showNotification('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∫–∞–∫ PNG');
        }

        function shareDrawing() {
            if (navigator.share) {
                canvas.toBlob(function(blob) {
                    navigator.share({
                        files: [new File([blob], '–º–æ–π-—Ä–∏—Å—É–Ω–æ–∫.png', { type: 'image/png' })],
                        title: '–ú–æ–π —Ä–∏—Å—É–Ω–æ–∫',
                        text: '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ —è –Ω–∞—Ä–∏—Å–æ–≤–∞–ª!'
                    }).then(() => {
                        showNotification('–†–∏—Å—É–Ω–æ–∫ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');
                    }).catch(() => {
                        saveAsPNG();
                    });
                });
            } else {
                saveAsPNG();
            }
        }

        // –£—Ç–∏–ª–∏—Ç—ã
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function showNotification(message, duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, duration);
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>