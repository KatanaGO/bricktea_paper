<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Paint Messenger</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
</head>
<body>
    <div class="app">
        <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
        <div class="mobile-toolbar">
            <button id="mobileMenuBtn" class="mobile-menu-btn">‚ò∞</button>
            <div class="mobile-tools">
                <button id="mobileBrush" class="tool-btn active" title="–ö–∏—Å—Ç—å">üñåÔ∏è</button>
                <button id="mobileEraser" class="tool-btn" title="–õ–∞—Å—Ç–∏–∫">üßπ</button>
                <button id="mobileText" class="tool-btn" title="–¢–µ–∫—Å—Ç">üìù</button>
                <button id="mobileShapes" class="tool-btn" title="–§–∏–≥—É—Ä—ã">‚¨ú</button>
            </div>
            <button id="mobileSave" class="mobile-save-btn" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">üíæ</button>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (—Å–∫—Ä—ã—Ç–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö) -->
        <div class="toolbar desktop-only">
            <div class="tool-group">
                <button id="brushBtn" class="tool-btn active" title="–ö–∏—Å—Ç—å">üñåÔ∏è</button>
                <button id="lineBtn" class="tool-btn" title="–õ–∏–Ω–∏—è">üìè</button>
                <button id="rectBtn" class="tool-btn" title="–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫">‚¨ú</button>
                <button id="circleBtn" class="tool-btn" title="–ö—Ä—É–≥">‚≠ï</button>
                <button id="textBtn" class="tool-btn" title="–¢–µ–∫—Å—Ç">üìù</button>
                <button id="eraserBtn" class="tool-btn" title="–õ–∞—Å—Ç–∏–∫">üßπ</button>
            </div>
            
            <div class="tool-group">
                <label class="color-label">
                    <span>–¶–≤–µ—Ç:</span>
                    <input type="color" id="colorPicker" value="#000000" title="–¶–≤–µ—Ç">
                </label>
                <label class="size-label">
                    <span>–†–∞–∑–º–µ—Ä:</span>
                    <input type="range" id="brushSize" min="1" max="50" value="5" title="–†–∞–∑–º–µ—Ä –∫–∏—Å—Ç–∏">
                    <span id="brushSizeValue">5</span>
                </label>
                <label class="type-label">
                    <span>–¢–∏–ø:</span>
                    <select id="brushType" title="–¢–∏–ø –∫–∏—Å—Ç–∏">
                        <option value="round">–ö—Ä—É–≥–ª–∞—è</option>
                        <option value="square">–ö–≤–∞–¥—Ä–∞—Ç–Ω–∞—è</option>
                        <option value="dashed">–ü—É–Ω–∫—Ç–∏—Ä</option>
                    </select>
                </label>
            </div>

            <div class="tool-group">
                <button id="undoBtn" title="–û—Ç–º–µ–Ω–∏—Ç—å">‚Ü©Ô∏è</button>
                <button id="redoBtn" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å">‚Ü™Ô∏è</button>
                <button id="clearBtn" title="–û—á–∏—Å—Ç–∏—Ç—å">üóëÔ∏è</button>
                <button id="settingsBtn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
            </div>
        </div>

        <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
        <div id="mobileMenu" class="mobile-menu">
            <div class="mobile-menu-header">
                <h3>–ú–µ–Ω—é</h3>
                <button id="closeMobileMenu" class="close-btn">‚úï</button>
            </div>
            <div class="mobile-menu-content">
                <div class="mobile-menu-section">
                    <h4>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h4>
                    <button class="mobile-menu-item" data-action="brush">üñåÔ∏è –ö–∏—Å—Ç—å</button>
                    <button class="mobile-menu-item" data-action="line">üìè –õ–∏–Ω–∏—è</button>
                    <button class="mobile-menu-item" data-action="rect">‚¨ú –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫</button>
                    <button class="mobile-menu-item" data-action="circle">‚≠ï –ö—Ä—É–≥</button>
                    <button class="mobile-menu-item" data-action="text">üìù –¢–µ–∫—Å—Ç</button>
                    <button class="mobile-menu-item" data-action="eraser">üßπ –õ–∞—Å—Ç–∏–∫</button>
                </div>
                
                <div class="mobile-menu-section">
                    <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h4>
                    <button class="mobile-menu-item" data-action="layers">üìö –°–ª–æ–∏</button>
                    <button class="mobile-menu-item" data-action="templates">üé® –®–∞–±–ª–æ–Ω—ã</button>
                    <button class="mobile-menu-item" data-action="background">üñºÔ∏è –§–æ–Ω</button>
                    <button class="mobile-menu-item" data-action="collab">üë• –°–æ–≤–º–µ—Å—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞</button>
                </div>

                <div class="mobile-menu-section">
                    <h4>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</h4>
                    <button class="mobile-menu-item" data-action="savePNG">üíæ PNG</button>
                    <button class="mobile-menu-item" data-action="saveJPG">üñºÔ∏è JPG</button>
                    <button class="mobile-menu-item" data-action="copyClipboard">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="mobile-menu-item" data-action="share">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
                </div>
            </div>
        </div>

        <!-- –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –¥–ª—è –º–µ–Ω—é -->
        <div id="mobileOverlay" class="mobile-overlay"></div>

        <!-- –ü–∞–Ω–µ–ª—å —Å–ª–æ–µ–≤ -->
        <div id="layersPanel" class="panel layers-panel">
            <div class="panel-header">
                <h4>–°–ª–æ–∏</h4>
                <div class="panel-actions">
                    <button id="addLayer" class="icon-btn" title="–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–π">+</button>
                    <button id="mergeLayers" class="icon-btn" title="–û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å–ª–æ–∏">üîÑ</button>
                    <button id="closeLayers" class="close-btn">‚úï</button>
                </div>
            </div>
            <div id="layersList" class="layers-list"></div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —à–∞–±–ª–æ–Ω–æ–≤ -->
        <div id="templatesPanel" class="panel templates-panel">
            <div class="panel-header">
                <h4>–®–∞–±–ª–æ–Ω—ã</h4>
                <button id="closeTemplates" class="close-btn">‚úï</button>
            </div>
            <div class="templates-grid">
                <div class="template-item" data-template="comic">
                    <div class="template-preview">ü¶∏</div>
                    <span>–ö–æ–º–∏–∫—Å</span>
                </div>
                <div class="template-item" data-template="storyboard">
                    <div class="template-preview">üé¨</div>
                    <span>–†–∞—Å–∫–∞–¥—Ä–æ–≤–∫–∞</span>
                </div>
                <div class="template-item" data-template="mindmap">
                    <div class="template-preview">üß†</div>
                    <span>–ú–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞</span>
                </div>
                <div class="template-item" data-template="ui">
                    <div class="template-preview">üì±</div>
                    <span>UI –º–∞–∫–µ—Ç</span>
                </div>
                <div class="template-item" data-template="flowchart">
                    <div class="template-preview">üìä</div>
                    <span>–ë–ª–æ–∫-—Å—Ö–µ–º–∞</span>
                </div>
                <div class="template-item" data-template="sketch">
                    <div class="template-preview">‚úèÔ∏è</div>
                    <span>–≠—Å–∫–∏–∑</span>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Ñ–æ–Ω–æ–≤ -->
        <div id="backgroundPanel" class="panel background-panel">
            <div class="panel-header">
                <h4>–§–æ–Ω</h4>
                <button id="closeBackground" class="close-btn">‚úï</button>
            </div>
            <div class="background-grid">
                <div class="background-item" data-background="transparent">
                    <div class="background-preview transparent-bg"></div>
                    <span>–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π</span>
                </div>
                <div class="background-item" data-background="white">
                    <div class="background-preview white-bg"></div>
                    <span>–ë–µ–ª—ã–π</span>
                </div>
                <div class="background-item" data-background="grid">
                    <div class="background-preview grid-bg"></div>
                    <span>–°–µ—Ç–∫–∞</span>
                </div>
                <div class="background-item" data-background="lined">
                    <div class="background-preview lined-bg"></div>
                    <span>–õ–∏–Ω–æ–≤–∫–∞</span>
                </div>
                <div class="background-item" data-background="graph">
                    <div class="background-preview graph-bg"></div>
                    <span>–ú–∏–ª–ª–∏–º–µ—Ç—Ä–æ–≤–∫–∞</span>
                </div>
                <div class="background-item" data-action="custom">
                    <div class="background-preview custom-bg">+</div>
                    <span>–°–≤–æ–π —Ñ–æ–Ω</span>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã -->
        <div id="collabPanel" class="panel collab-panel">
            <div class="panel-header">
                <h4>–°–æ–≤–º–µ—Å—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞</h4>
                <button id="closeCollab" class="close-btn">‚úï</button>
            </div>
            <div class="collab-content">
                <div class="collab-section">
                    <button id="startCollab" class="collab-btn primary">üéÆ –ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é</button>
                    <div class="session-info">
                        <label>ID –≤–∞—à–µ–π —Å–µ—Å—Å–∏–∏:</label>
                        <div class="session-id-container">
                            <input type="text" id="sessionId" readonly>
                            <button id="copySessionId" class="icon-btn">üìã</button>
                        </div>
                    </div>
                </div>
                
                <div class="collab-section">
                    <div class="join-section">
                        <input type="text" id="joinSessionId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID —Å–µ—Å—Å–∏–∏">
                        <button id="joinCollab" class="collab-btn secondary">‚úÖ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
                    </div>
                </div>
                
                <div class="collab-section">
                    <div id="usersList" class="users-list">
                        <div class="user-item host">
                            <span class="user-icon">üë§</span>
                            <span class="user-name">–í—ã (–≤–ª–∞–¥–µ–ª–µ—Ü)</span>
                        </div>
                    </div>
                </div>
                
                <div class="collab-status" id="collabStatus">
                    <span class="status-icon">üî¥</span>
                    <span class="status-text">–ù–µ–∞–∫—Ç–∏–≤–Ω–æ</span>
                </div>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ö–æ–ª—Å—Ç–∞ -->
        <div class="canvas-container">
            <canvas id="paintCanvas"></canvas>
            <div class="canvas-overlay" id="canvasOverlay"></div>
        </div>

        <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="mobile-actions">
            <button id="mobileUndo" title="–û—Ç–º–µ–Ω–∏—Ç—å">‚Ü©Ô∏è</button>
            <button id="mobileClear" title="–û—á–∏—Å—Ç–∏—Ç—å">üóëÔ∏è</button>
            <button id="mobileRedo" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å">‚Ü™Ô∏è</button>
            <button id="mobileBackground" title="–§–æ–Ω">üñºÔ∏è</button>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div id="notification" class="notification">
            <span id="notificationText"></span>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>